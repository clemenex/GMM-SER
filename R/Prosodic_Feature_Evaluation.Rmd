---
title: "Prosodic Feature Evaluation: 30s vs. 60s Windows"
author: "Your Name"
date: "`r Sys.Date()`"
output: html_document
---

# âœ… **Setup**
Load required libraries and data.

```{r setup, message=FALSE, warning=FALSE}
library(tidyverse)

# Load prosodic summary CSVs
df_30 <- read_csv("data/daic_prosodic_summary_30s.csv") %>% mutate(window_size='30')
df_60 <- read_csv("data/daic_prosodic_summary_60s.csv") %>% mutate(window_size='60')

# Combine into one dataset for comparison
df_all <- bind_rows(df_30, df_60)


# **Feature Distribution Comparison**

- **Pitch Variation**
ggplot(df_all, aes(x=energy_sd, fill=window_size)) +
  geom_density(alpha=0.5) +
  labs(title="Energy Variation (SD): 30s vs 60s Windows",
       x="Energy Standard Deviation", y="Density",
       fill="Window Size") +
  theme_minimal(base_size=14)


- **Energy Variation**
ggplot(df_all, aes(x=energy_sd, fill=window_size)) +
  geom_density(alpha=0.5) +
  labs(title="Energy Variation (SD): 30s vs 60s Windows",
       x="Energy Standard Deviation", y="Density",
       fill="Window Size") +
  theme_minimal(base_size=14)

*(Visualizations to compare distributions.)*


# **Feature Stability Evaluation**

stability <- df_all %>%
  group_by(participant_id, window_size) %>%
  summarise(
    pitch_cv = sd(pitch_mean, na.rm=TRUE)/mean(pitch_mean, na.rm=TRUE),
    energy_cv = sd(energy_mean, na.rm=TRUE)/mean(energy_mean, na.rm=TRUE)
  ) %>%
  ungroup()

# Visualize stability
stability %>%
  pivot_longer(cols = c(pitch_cv, energy_cv)) %>%
  ggplot(aes(x=window_size, y=value, fill=window_size)) +
  geom_boxplot(alpha=0.7) +
  facet_wrap(~name, scales='free_y') +
  labs(title="Prosodic Feature Stability by Window Size",
       y="Coefficient of Variation (Lower = More Stable)",
       x="Window Size (seconds)") +
  theme_minimal(base_size=14)


# **Statistical Testing**

pitch_test <- t.test(pitch_cv ~ window_size, data = stability)
pitch_test

energy_test <- t.test(energy_cv ~ window_size, data = stability)
energy_test


# **Summary Table**

stability %>%
  group_by(window_size) %>%
  summarise(
    Mean_Pitch_CV = mean(pitch_cv, na.rm=TRUE),
    Mean_Energy_CV = mean(energy_cv, na.rm=TRUE)
  ) %>%
  knitr:kable(digits = 3, caption="Mean CV for Prosodic Features by Window Size")
  
